
<div class="grid grid-rows-1 mb-20 min-w-full">

  <%= turbo_frame_tag 'scratchpad' do %>
    <%= render partial: "scratchpad/form" %>
  <% end %>


  <% @shopping_categories.each do |category| %>
    <div data-controller="toggle-item-form toggle-item-list"  class="mt-6">
      
      <%# Category Title with toggle %>
      <div data-toggle-item-list-target="title"
        class="mb-4 px-5 mx-[-10px] py-2 space-x-2 flex justify-between
        shadow-md shadow-stone-200 border-t-2 border-stone-400 bg-stone-50">

          <h2 data-action="click->toggle-item-list#toggleList" 
          class="text-xl font-bold cursor-pointer"><%= category.title %></h2>

        <button class="font-black text-stone-600 " data-action="click->toggle-item-form#toggleForm" data-category-id="<%= category.id %>">
        
        <%= render partial: "svgs/plus", locals: { classes: "stroke-2" } %>
        </button>
      </div>
      <%# END Category Title %>

      <%#  Item List with initially hidden form %>
      <div class="">

        <%# Form, hidden by default %>
        <%= render partial: "inline_shopping_form",
          locals: { category: category, item: ShoppingItem.new, hide_form: true } %>

        <div data-toggle-item-list-target="list" id="shopping-items-<%= category.id %>"
              class="flex flex-wrap gap-2">
          
          <%# Sort items first by stock, then by importance %>
          <% category.shopping_items.order(stock: :desc).sort_by(&:importance).each do |item| %>

            <%= render partial: "dashboard/shopping_item", locals: { item: item } %>
           <% end %>   
        </div>

      </div>
      <%# END Item List %>

    </div>
    
  <% end %>
</div>